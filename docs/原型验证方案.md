# 原型验证方案

## 1. 验证目标

本次原型验证旨在解决项目中风险最高、不确定性最大的部分，核心目标如下：

-   **验证数据管道**: 证明我们能成功地从 `akshare` 获取数据，通过 `SQLAlchemy` 存入 SQLite 数据库，并能成功地再读出，验证端到端的数据流。
-   **验证数据标准化**: 证明我们设计的“科目名映射”机制能够有效处理来自 `akshare` 的不一致的财务报表列名。
-   **验证核心计算**: 证明我们能基于存入数据库的数据，正确地计算出一个关键财务指标（ROE），确保数据在整个流程中没有失真。

## 2. 原型范围

为保证验证的聚焦和高效，本次原型将严格限制范围：

-   **数据样本**: 只处理 **3-5 只**有代表性的股票（如：贵州茅台、宁德时代、京东方A），不涉及全市场数据。
-   **功能范围**:
    -   一个完整的原型验证脚本 (`prototype.py`)，包含所有验证逻辑。
    -   一个包含核心映射规则的 `column_mapping.yaml` 配置文件。
    -   内联的 ROE 计算逻辑（在原型脚本中实现）。

## 3. 实施步骤

1.  **环境搭建**: 创建 `requirements.txt` 文件并安装 `akshare`, `pandas`, `sqlalchemy`, `pyyaml` 等核心依赖。
2.  **数据模型定义**: 在 `models.py` 中使用 SQLAlchemy 定义 `balance_sheets` 和 `income_statements` 的表结构。
3.  **原型脚本开发**: 在 `prototype.py` 中实现完整的验证流程：
    -   连接 `akshare` 获取指定股票的资产负债表和利润表数据。
    -   加载 `column_mapping.yaml`，对获取到的 DataFrame 进行列名标准化处理。
    -   使用 `SQLAlchemy` 将标准化后的数据存入 SQLite 数据库。
    -   从 SQLite 数据库中读出已存储的数据。
    -   计算 ROE 并输出结果。
    -   测试多只股票的数据获取。
4.  **执行验证**: 运行 `python prototype.py`，观察输出结果。
5.  **结果验证**: 将计算出的 ROE 结果与财经网站（如东方财富）公开的数据进行手动比对。

## 4. 验收标准

-   [x] `prototype.py` 能够无错误地运行完成。
-   [x] 程序成功创建 `database_test.sqlite` 文件，并且其中的表结构和数据均符合预期。
-   [x] 列名标准化功能按预期工作，akshare 返回的英文列名被成功映射到内部标准名称。
-   [x] 成功计算出 ROE 值并输出详细的计算过程。
-   [x] 成功测试多只股票的数据获取（贵州茅台、宁德时代、京东方A）。

## 5. 交付物

-   `prototype.py`: 包含所有原型代码和验证步骤的 Python 脚本。
-   `database_test.sqlite`: 包含原型数据的数据库文件。
-   `requirements.txt`: 项目依赖文件。
-   `models.py`: 数据模型定义文件。
-   `column_mapping.yaml`: 科目名映射配置文件。
-   一份简短的《原型验证报告》，总结验证过程和结论。

## 6. 待确认事项

-   无
